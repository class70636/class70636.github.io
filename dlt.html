<!doctype html>
<html lang="en" data-bs-theme="dark">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        /* body {
            margin: 0;
            padding: 0;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://el.phncdn.com/gif/43400471.gif');
            background-size: 120%;
            background-position: center;
            background-repeat: no-repeat;
            opacity: 0.025;
            z-index: -1;
        } */

        .background-image-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('https://el.phncdn.com/gif/43400471.gif');
            /* Replace with your image path */
            background-size: 120%;
            background-position: center;
            background-repeat: no-repeat;
            opacity: 0;
            /* Initial opacity */
            z-index: -1;
            /* Place the container behind other content */
        }

        .custom-no-arrow::after {
            display: none;
        }

        /* 將數字包裹在一個容器中 */
        .circle-container {
            display: flex;
            justify-content: space-around;
        }

        /* 定義圓圈的樣式 */
        .circle {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            /* border: 2px solid #000; */
            /* 圓圈的邊框樣式 */
            /* margin: 15px; */
            /* 圓圈之間的間距 */
            font-size: 30px;
            /* 數字的字體大小 */
            font-weight: bold;
            background: 50%/cover no-repeat url(https://www.taiwanlottery.com/images/bg/ball.svg);
            ;
            color: black;
        }

        .not-circle {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 1px solid #ffffff;
            /* 圓圈之間的間距 */
            font-size: 30px;
            /* 數字的字體大小 */
            font-weight: bold;

            color: white;
        }

        /* 設定整個頁面的高度 */
        body,
        html {
            height: 100%;
        }

        /* 設定特定 div 的高度，並在需要的時候顯示滾動條 */
        .scrollable-div {
            height: 85vh;
            /* 設定 div 的高度 */
            /* border: 1px solid #ccc; */
            /* 可選：添加邊框樣式 */
        }

        #typeData {
            border: none;
        }

        #typeData:focus {
            border: none;
        }

        .left-image,
        .right-image {
            position: fixed;
            top: 0;
            height: 100%;
            width: auto;
        }

        .left-image {
            left: 0;
        }

        .no-thumb::-webkit-slider-thumb {
            appearance: none;
            width: 0;
            /* Set thumb width to 0 */
        }

        .no-thumb::-moz-range-thumb {
            appearance: none;
            width: 0;
            /* Set thumb width to 0 */
        }

        .no-thumb::-ms-thumb {
            appearance: none;
            width: 0;
            /* Set thumb width to 0 */
        }

        img:hover {
            cursor: pointer;
        }
    </style>
</head>

<body>
    <!-- <div class="left-image">
        <img src="43400471.gif" alt="Left Image">
    </div> -->

    <div class="background-image-container" id="bgimage"></div>
    <!-- <div class="container-fluid">
        <div class="row">
            <div class="col">
                <img src="https://www.pornfind.org/images/friend/0/589.webp?1697982245" alt="Right Image"
                    class="img-fluid mt-2">
            </div>
            <div class="col">
                <img src="https://www.pornfind.org/images/friend/0/589.webp?1697982245" alt="Right Image"
                    class="img-fluid mt-2">
            </div>
            <div class="col">
                <img src="https://www.pornfind.org/images/friend/0/589.webp?1697982245" alt="Right Image"
                    class="img-fluid mt-2">
            </div>
        </div>
        <div class="row">
            <div class="col">
                <img src="https://www.pornfind.org/images/friend/0/589.webp?1697982245" alt="Right Image"
                    class="img-fluid mt-2">
            </div>
            <div class="col">
                <img src="https://www.pornfind.org/images/friend/0/589.webp?1697982245" alt="Right Image"
                    class="img-fluid mt-2">
            </div>
            <div class="col">
                <img src="https://www.pornfind.org/images/friend/0/589.webp?1697982245" alt="Right Image"
                    class="img-fluid mt-2">
            </div>
        </div>
    </div> -->
    <div class="container-fluid h-100">
        <div class="row">
            <div class="col-md-2 fixed-column">
                <!-- Left image  -->
                <img src="https://www.pornfind.org/images/friend/0/568.webp?1693484426" alt="" class="img-fluid mt-2">
                <img src="https://www.pornfind.org/images/friend/0/630.webp?1706003571" alt="" class="img-fluid mt-2">
                <img src="https://www.pornfind.org/images/friend/0/527.webp?1687271511" alt="" class="img-fluid mt-2">
                <img src="https://www.pornfind.org/images/friend/0/597.webp?1701142936" alt="" class="img-fluid mt-2">
                <img src="https://www.pornfind.org/images/friend/0/492.webp?1682596728" alt="" class="img-fluid mt-2">
                <img src="https://www.pornfind.org/images/friend/0/530.webp?1687953891" alt="" class="img-fluid mt-2">
                <img src="https://www.pornfind.org/images/friend/0/601.webp?1702284693" alt="" class="img-fluid mt-2">
                <img src="https://www.pornfind.org/images/friend/0/621.webp?1705885868" alt="" class="img-fluid mt-2">
            </div>
            <div class="col-md-8 scrollable-column">
                <!-- Center column with scrollable content -->
                <div class="content">
                    <div class="row">
                        <div class="container">
                            <div class="alert alert-primary mt-3 text-center mb-0" role="alert" id="closestData">
                                <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                                讀取資料中...
                            </div>
                            <div class="alert alert-primary mt-3 text-center mb-0 d-none" role="alert"
                                id="typeDataAlert">
                                <input type="text" class="form-control text-center" id="typeData" placeholder="輸入獎號"
                                    style="background-color: rgba(255, 255, 255, 0);">
                            </div>
                            <div class="form-check form-switch float-end">
                                <input class="form-check-input" type="checkbox" role="switch" id="typeDrawNumber"
                                    onchange="switchTypeDrawNumber(this)">
                                <label class="form-check-label" for="flexSwitchCheckDefault"
                                    id="typeDrawNumberLb">自動數據</label>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="container">
                                <div class="row">
                                    <div class="mt-3">
                                        <label for="checkNumbers" class="form-label">輸入需要檢查的號碼</label>
                                        <textarea class="form-control" id="checkNumbers" rows="3"
                                            style="max-height: 500px; min-height: 300px;"></textarea>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="btn-group" role="group" aria-label="Basic mixed styles example">
                                        <button type="button" class="btn btn-primary"
                                            onclick="checkReapeatOfSelf()">組內檢查</button>
                                        <button type="button" class="btn btn-success"
                                            onclick="checkReapeatOfHistory()">與歷史紀錄檢查</button>
                                        <button type="button" class="btn btn-danger"
                                            onclick="removeSearching()">清除</button>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="btn-group" role="group" aria-label="Basic mixed styles example">
                                        <button type="button" class="btn btn-warning"
                                            onclick="checkHistoryOfSelf()">歷史紀錄統計</button>
                                        <button type="button" class="btn btn-info" onclick="autoPrize()"
                                            id="autoPrize">自動對號</button>
                                    </div>
                                </div>
                                <input type="range" class="form-range no-thumb" min="0" max="1" step="0.005"
                                    id="customRange3" value="0" oninput="bgop(this)" style="opacity: 0.1;">
                            </div>
                        </div>
                        <div class="col">
                            <div class="mt-3 scrollable-div overflow-auto">
                                <div class="accordion" id="resultShower">
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            <div class="col-md-2 fixed-column p-2">
                <!-- Right column with image -->
                <img src="https://www.pornfind.org/images/friend/0/589.webp?1697982245" alt="Right Image"
                    class="img-fluid mt-2">
                <img src="https://www.pornfind.org/images/friend/0/544.webp?1701524405" alt="Right Image"
                    class="img-fluid mt-2">
                <img src="https://www.pornfind.org/images/friend/0/455.webp?1689775830" alt="" class="img-fluid mt-2">
                <img src="https://www.pornfind.org/images/friend/0/602.webp?1702033515" alt="" class="img-fluid mt-2">
                <img src="https://www.pornfind.org/images/friend/0/439.webp?1704811304" alt="" class="img-fluid mt-2">
                <img src="https://www.pornfind.org/images/friend/0/600.webp?1702284675" alt="" class="img-fluid mt-2">
                <img src="https://www.pornfind.org/images/friend/0/623.webp?1704953217" alt="" class="img-fluid mt-2">
                <img src="https://www.pornfind.org/images/friend/0/560.webp?1692421821" alt="" class="img-fluid mt-2">
            </div>
        </div>
    </div>

    <!-- <div class="container-fluid h-100" style="width: 80%;">
        <div class="row">
            <div class="container">
                <div class="alert alert-primary mt-3 text-center mb-0" role="alert" id="closestData">
                </div>
                <div class="alert alert-primary mt-3 text-center mb-0 d-none" role="alert" id="typeDataAlert">
                    <input type="text" class="form-control text-center" id="typeData" placeholder="輸入獎號"
                        style="background-color: rgba(255, 255, 255, 0);">
                </div>
                <div class="form-check form-switch float-end">
                    <input class="form-check-input" type="checkbox" role="switch" id="typeDrawNumber"
                        onchange="switchTypeDrawNumber(this)">
                    <label class="form-check-label" for="flexSwitchCheckDefault" id="typeDrawNumberLb">自動數據</label>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <div class="container">
                    <div class="row">
                        <div class="mt-3">
                            <label for="checkNumbers" class="form-label">輸入需要檢查的號碼</label>
                            <textarea class="form-control" id="checkNumbers" rows="3"
                                style="max-height: 500px; min-height: 300px;"></textarea>
                        </div>
                    </div>
                    <div class="row">
                        <div class="btn-group" role="group" aria-label="Basic mixed styles example">
                            <button type="button" class="btn btn-primary" onclick="checkReapeatOfSelf()">組內檢查</button>
                            <button type="button" class="btn btn-success"
                                onclick="checkReapeatOfHistory()">與歷史紀錄檢查</button>
                            <button type="button" class="btn btn-danger" onclick="removeSearching()">清除</button>
                        </div>
                    </div>
                    <div class="row">
                        <div class="btn-group" role="group" aria-label="Basic mixed styles example">
                            <button type="button" class="btn btn-warning" onclick="checkHistoryOfSelf()">歷史紀錄統計</button>
                            <button type="button" class="btn btn-info" onclick="autoPrize()">自動對號</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col">
                <div class="mt-3 scrollable-div overflow-auto">
                    <div class="accordion" id="resultShower">
                    </div>
                </div>
            </div>

        </div>
    </div> -->
    <!-- Modal -->
    <div class="modal fade" id="loadingModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center" id="loadingModalBody">
                    <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                    <span>讀取資料中...</span>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
    <script>

        var myModal;
        document.addEventListener("DOMContentLoaded", () => {
            myModal = new bootstrap.Modal(document.getElementById('loadingModal'));
            // myModal.show();

            //抓取大樂透資料
            // catchDatas();
        });

        const img = document.querySelectorAll('img');
        img.forEach(i => {
            i.addEventListener("click", () => {
                alert('沒付錢還想看阿！？');
            });
        });

        var LTDDatas = [];
        var closestTempData = null; //最靠近今天的開獎資料
        var newestDrawDataDisplay;
        function catchDatas() {
            //抓取日為2007-01至今
            var startDate = new Date('2007-01');
            var endDate = new Date();

            //
            var closestDate = new Date('9999-12-31');
            var currentDate = new Date();

            var fetchError = false;

            // 收集所有 fetch 的 Promise
            const fetchPromises = [];


            while (startDate <= endDate) {
                const dateFormatt = `${startDate.getFullYear()}-${(startDate.getMonth() + 1).toString().padStart(2, '0')}`;
                const fetchPromise = fetch(`https://api.taiwanlottery.com/TLCAPIWeB/Lottery/Lotto649Result?period&month=${dateFormatt}`)
                    .then(response => response.json())
                    .then(response => {
                        // const temp = response.content.lotto649Res;
                        // temp.forEach(t => {
                        //     if (t.length > 0) {
                        //         t.drawNumberSize.pop();
                        //         tempData.push(t.drawNumberSize);
                        //     }
                        // });
                        if (response.content.totalSize > 0)
                            response.content.lotto649Res.forEach(n => {
                                n.drawNumberSize.pop();
                                for (let i = 0; i < n.drawNumberSize.length; i++)
                                    n.drawNumberSize[i] = n.drawNumberSize[i].toString();
                                LTDDatas.push(n);

                                //找出最靠近今日的資料
                                var tempDate = new Date(n.lotteryDate);
                                var timeDiff = Math.abs(currentDate - tempDate);
                                if (timeDiff < closestDate) {
                                    closestDate = timeDiff;
                                    closestTempData = n;
                                }
                            })
                    })
                    .catch(error => {
                        console.log(`Error: ${error}`);
                        const loadingModalBody = document.getElementById('loadingModalBody');
                        loadingModalBody.innerHTML = `
                        <i class="bi bi-arrow-clockwise text-danger"></i> 資料讀取失敗，請重新整理
                        `;
                        myModal.show();
                        fetchError = true;
                    });

                fetchPromises.push(fetchPromise);

                startDate.setMonth(startDate.getMonth() + 1);
            }

            Promise.all(fetchPromises).then(() => {
                if (!fetchError)
                    myModal.hide();

                //顯示最新一期資訊
                const closestData = document.getElementById('closestData');
                const cdNumbers = closestTempData.drawNumberSize;
                const speNumber = closestTempData.drawNumberAppear[6];
                const drawDate = new Date(closestTempData.lotteryDate);
                // 創建星期幾的數字對應表
                const weekdays = ["星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六"];
                // 獲取日期對應的星期數字
                var weekdayNumber = drawDate.getDay();
                var dateDisplay = `${drawDate.getFullYear()}/${drawDate.getMonth() + 1}/${drawDate.getDate()} ${weekdays[weekdayNumber]}`;

                var display = `最新一期：#${closestTempData.period}　[ ${cdNumbers[0]} , ${cdNumbers[1]} , ${cdNumbers[2]} , ${cdNumbers[3]} , ${cdNumbers[4]} , ${cdNumbers[5]} , ${speNumber} ]　(${dateDisplay})`;
                closestData.innerHTML = newestDrawDataDisplay = display;

                // myModal.hide();
            }).catch(error => {
                console.log(`Error: ${error}`);
                const loadingModalBody = document.getElementById('loadingModalBody');
                loadingModalBody.innerHTML = `
                        <i class="bi bi-arrow-clockwise text-danger"></i> 資料讀取失敗，請重新整理
                        `;
                myModal.show();
            });
        }

        var checkNumbersArr = [];
        function checkReapeatOfSelf() {
            checkNumbersArr = []
            const checkNumbers = document.getElementById('checkNumbers');
            if (checkNumbers.value.length == 0) return;
            const period = checkNumbers.value.split('\n');
            period.forEach(n => {
                checkNumbersArr.push(n.split(','));
            })
            // console.log(checkNumbersArr);

            const resultShower = document.getElementById('resultShower');
            resultShower.innerHTML = '';
            repeatCalc();


            function repeatCalc() {
                var temp_data = [];

                for (let i = 0; i < checkNumbersArr.length; i++) {
                    // 計算重複
                    var counts = {
                        4: [],
                        5: [],
                        6: []
                    };

                    const arr1 = checkNumbersArr[i];
                    const uniqueNumbers1 = new Set(arr1);

                    for (let j = 0; j < checkNumbersArr.length; j++) {
                        if (i == j) continue;
                        const arr2 = checkNumbersArr[j];
                        const uniqueNumbers2 = new Set(arr2);

                        var commonNumbers = [...uniqueNumbers1].filter(num => uniqueNumbers2.has(num));
                        var commonCount = commonNumbers.length;

                        if (commonCount >= 4 && commonCount <= 6) {
                            // counts[commonCount]++;
                            counts[commonCount].push(j);
                        }
                        // total_counts++;
                    }

                    temp_data.push(counts);
                }

                // console.log(temp_data);
                for (let i = 0; i < temp_data.length; i++) {
                    const cna = checkNumbersArr[i];
                    let temp_str = `[ ${cna[0]} , ${cna[1]} , ${cna[2]} , ${cna[3]} , ${cna[4]} , ${cna[5]} ]`;
                    //有重複的次數是否大於0
                    const repeat_counts = temp_data[i][4].length + temp_data[i][5].length + temp_data[i][6].length;
                    const btn_element = `
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="heading-${i}">
                                <button class="accordion-button collapsed ${repeat_counts == 0 ? `custom-no-arrow` : ``}" type="button"
                                    data-bs-toggle="collapse" data-bs-target="#collapse-${i}" aria-expanded="false"
                                    aria-controls="collapse-${i}" ${repeat_counts == 0 ? `disabled` : ``}>
                                    ${repeat_counts == 0 ? `<i class="bi bi-check-square-fill text-success"></i>` : `<i class="bi bi-exclamation-triangle-fill text-warning"></i>`}　#${i + 1}　${temp_str}
                                </button>
                            </h2>
                            <div id="collapse-${i}" class="accordion-collapse collapse" aria-labelledby="heading-${i}"
                                data-bs-parent="#resultShower">
                                <div class="accordion-body">
                                    ${getAccBody()}
                                </div>
                            </div>
                        </div>
                    `;
                    resultShower.innerHTML += btn_element;

                    function getAccBody() {
                        let temp = ``;
                        for (let j = 4; j <= 6; j++) {
                            if (temp_data[i][j].length == 0) continue;
                            let temp2 = ``;
                            for (let k = 0; k < temp_data[i][j].length; k++) {
                                const n = temp_data[i][j];
                                const index = n[k];
                                const temp3 = `[ ${checkNumbersArr[index][0]} , ${checkNumbersArr[index][1]} , ${checkNumbersArr[index][2]} , ${checkNumbersArr[index][3]} , ${checkNumbersArr[index][4]} , ${checkNumbersArr[index][5]} ]`;
                                temp2 += `#${n[k] + 1}　${temp3}<br>`;
                            }
                            temp += `
                            <div class="card mb-1">
                                <div class="card-header">
                                    與以下組別有 ${j} 個重複
                                </div>
                                <div class="card-body">
                                    ${temp2}
                                </div>
                            </div>
                            `;
                        }
                        return temp;
                    }
                }
            }

        }
        var temp_data = [];
        function checkReapeatOfHistory() {

            checkNumbersArr = []
            const checkNumbers = document.getElementById('checkNumbers');
            if (checkNumbers.value.length == 0) return;
            const period = checkNumbers.value.split('\n');
            period.forEach(n => {
                checkNumbersArr.push(n.split(','));
            })
            // console.log(checkNumbersArr);

            const resultShower = document.getElementById('resultShower');
            resultShower.innerHTML = '';

            repeatCalc();

            function repeatCalc() {
                temp_data = [];
                for (let i = 0; i < checkNumbersArr.length; i++) {
                    // 計算重複
                    var counts = {
                        4: [],
                        5: [],
                        6: []
                    };

                    const arr1 = checkNumbersArr[i];
                    const uniqueNumbers1 = new Set(arr1);

                    //與歷史紀錄檢查
                    for (let j = 0; j < LTDDatas.length; j++) {
                        const arr2 = LTDDatas[j].drawNumberSize;
                        const uniqueNumbers2 = new Set(arr2);

                        var commonNumbers = [...uniqueNumbers1].filter(num => uniqueNumbers2.has(num));
                        var commonCount = commonNumbers.length;

                        if (commonCount >= 4 && commonCount <= 6) {
                            // counts[commonCount]++;
                            counts[commonCount].push(j);
                        }
                        // total_counts++;
                    }

                    temp_data.push(counts);
                }

                // console.log(temp_data);

                for (let i = 0; i < temp_data.length; i++) {
                    const cna = checkNumbersArr[i];
                    let temp_str = `[ ${cna[0]} , ${cna[1]} , ${cna[2]} , ${cna[3]} , ${cna[4]} , ${cna[5]} ]`;
                    //有重複的次數是否大於0
                    const repeat_counts = temp_data[i][4].length + temp_data[i][5].length + temp_data[i][6].length;
                    const btn_element = `
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="heading-${i}">
                                <button class="accordion-button collapsed ${repeat_counts == 0 ? `custom-no-arrow` : ``}" type="button"
                                    data-bs-toggle="collapse" data-bs-target="#collapse-${i}" aria-expanded="false"
                                    aria-controls="collapse-${i}" ${repeat_counts == 0 ? `disabled` : ``}>
                                    ${repeat_counts == 0 ? `<i class="bi bi-check-square-fill text-success"></i>` : `<i class="bi bi-exclamation-triangle-fill text-warning"></i>`}　#${i + 1}　${temp_str}
                                </button>
                            </h2>
                            <div id="collapse-${i}" class="accordion-collapse collapse" aria-labelledby="heading-${i}"
                                data-bs-parent="#resultShower">
                                <div class="accordion-body">
                                    ${getAccBody()}
                                </div>
                            </div>
                        </div>
                    `;
                    resultShower.innerHTML += btn_element;

                    function getAccBody() {
                        let card_body = ``;
                        for (let j = 4; j <= 6; j++) {
                            if (temp_data[i][j].length == 0) continue;
                            const drawNumbers = temp_data[i][j]; //一堆重複的期數, arr
                            let repeatedPeriod = ``;
                            for (let k = 0; k < drawNumbers.length; k++) {
                                const drawIndex = drawNumbers[k];
                                const drawNumber = LTDDatas[drawIndex].drawNumberSize;
                                const drawNumberDisplay = `[ ${drawNumber[0]} , ${drawNumber[1]} , ${drawNumber[2]} , ${drawNumber[3]} , ${drawNumber[4]} , ${drawNumber[5]} ]`;
                                const period = LTDDatas[drawIndex].period;
                                repeatedPeriod += `#${period}　${drawNumberDisplay}<br>`;
                            }
                            card_body += `
                            <div class="card mb-1">
                                <div class="card-header">
                                    與以下期數有 ${j} 個重複
                                </div>
                                <div class="card-body">
                                    ${repeatedPeriod}
                                </div>
                            </div>
                            `
                        }
                        return card_body;
                    }
                }
            }
        }

        function checkHistoryOfSelf() {
            const resultShower = document.getElementById('resultShower');
            resultShower.innerHTML = '';

            var temp_data = []; //紀錄每期分別重複4,5,6個數字的統計
            for (let i = 0; i < LTDDatas.length; i++) {
                // 計算重複
                var counts = {
                    4: 0,
                    5: 0,
                    6: 0
                };

                const arr1 = LTDDatas[i].drawNumberSize;
                const uniqueNumbers1 = new Set(arr1);

                for (let j = 0; j < LTDDatas.length; j++) {
                    if (i == j) continue;
                    const arr2 = LTDDatas[j].drawNumberSize;
                    const uniqueNumbers2 = new Set(arr2);

                    var commonNumbers = [...uniqueNumbers1].filter(num => uniqueNumbers2.has(num));
                    var commonCount = commonNumbers.length;

                    if (commonCount >= 4 && commonCount <= 6) {
                        counts[commonCount]++;
                    }
                }

                temp_data.push(counts);
            }

            //所有期數的重複組數
            var counts = {
                4: 0,
                5: 0,
                6: 0
            };
            for (let i = 0; i < temp_data.length; i++) {
                for (let j = 4; j <= 6; j++) {
                    if (temp_data[i][j] > 0)
                        counts[j]++;
                }
            }

            const resultTable = `
            <label class="form-label">總抓取期數: ${temp_data.length}</label>
            <table class="table table-hover">
                <thead>
                    <tr>
                        <td>重複幾個</td>
                        <td>組數</td>
                        <td>百分比</td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>4</td>
                        <td>${counts[4]}</td>
                        <td>${((counts[4] / temp_data.length) * 100).toFixed(2)} %</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>${counts[5]}</td>
                        <td>${((counts[5] / temp_data.length) * 100).toFixed(2)} %</td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>${counts[6]}</td>
                        <td>${((counts[6] / temp_data.length) * 100).toFixed(2)} %</td>
                    </tr>
                </tbody>
            </table>
            `;

            resultShower.innerHTML += resultTable;
        }

        var typeDrawNumber = null; //手動輸入的開獎資料
        // var tempDrawData = null; // 用來自動對號
        var typedStatus = false;

        function switchTypeDrawNumber(n) {
            const closestData = document.getElementById('closestData');
            const typeAlert = document.getElementById('typeDataAlert');
            const label = document.getElementById('typeDrawNumberLb');
            if (typedStatus = n.checked) {
                closestData.classList.add('d-none');
                typeAlert.classList.remove('d-none');
                label.innerHTML = '手動數據';
            } else {
                closestData.classList.remove('d-none');
                typeAlert.classList.add('d-none');
                label.innerHTML = '自動數據';
            }
        }

        //自動對號
        function autoPrize() {
            var checkNumbersArr = []
            const checkNumbers = document.getElementById('checkNumbers');

            if (checkNumbers.value.length == 0) return;
            const period = checkNumbers.value.split('\n');
            period.forEach(n => {
                checkNumbersArr.push(n.split(','));
            })

            if (typedStatus) {
                const data = document.getElementById('typeData');
                if (data.value.length == 0) {
                    alert('請輸入獎號');
                    return;
                }
                typeDrawNumber = data.value.split(',');
            }

            //取得最新一期開講號
            const newsetDrawNumber = typedStatus ? typeDrawNumber : closestTempData.drawNumberAppear;

            var drawData = [];
            for (let i = 0; i < checkNumbersArr.length; i++) {
                var tempIndexs = [];
                const drawNumbers = checkNumbersArr[i];
                for (let j = 0; j < drawNumbers.length; j++) {
                    for (let k = 0; k < newsetDrawNumber.length; k++) {
                        if (drawNumbers[j] === newsetDrawNumber[k].toString()) {
                            tempIndexs.push(j);
                            break;
                        }
                    }
                }
                drawData.push(tempIndexs);
            }

            const resultShower = document.getElementById('resultShower');
            resultShower.innerHTML = ``;

            for (let i = 0; i < checkNumbersArr.length; i++) {
                var circles = ``;
                const drawNumber = checkNumbersArr[i];
                const dData = new Set(drawData[i]);
                for (let j = 0; j < drawNumber.length; j++) {
                    circles += `<div class="${dData.has(j) ? `circle` : `not-circle`}">${drawNumber[j]}</div>`;
                }
                const str = `
                <div class="card mt-2">
                    <h5 class="card-header">#${i + 1}</h5>
                    <div class="card-body">
                    <!-- 數字容器 -->
                        <div class="circle-container">
                        <!-- 每個數字都放在一個圓圈內 -->
                            ${circles}
                        </div>
                    </div>
                </div>
                `;

                resultShower.innerHTML += str;
            }
        }

        function removeSearching() {
            const checkNumbers = document.getElementById('checkNumbers');
            checkNumbers.value = '';

            const resultShower = document.getElementById('resultShower');
            resultShower.innerHTML = '';
        }

        function bgop(n) {
            const v = n.value;
            const bg = document.getElementById('bgimage');
            bg.style.opacity = v;
        }
    </script>
</body>

</html>