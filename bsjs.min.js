$(document).ready(function(){function t(){for(var t=[0,0,0,0,0],s=$(l[parseInt($("#search-type").val())]),a=0;a<s.length;a++){var n=s[a].getElementsByTagName("td")[0];if(n){var r=n.textContent||n.innerText;if(e(r)){s[a].style.display="";var i=n.parentNode.className;"qq"==i&&t[0]++,"tp"==i&&t[1]++,"ko"==i&&t[2]++,"gu"==i&&t[3]++,"bu"==i&&t[4]++}else s[a].style.display="none"}}0==t[0]&&$(".qq").css("display","none"),0==t[1]&&$(".tp").css("display","none"),0==t[2]&&$(".ko").css("display","none"),t[0]+t[1]+t[2]==0&&$(".ques").css("display","none"),0==t[3]&&$(".guwan").css("display","none"),0==t[4]&&$(".buqhai").css("display","none"),t[0]+t[1]+t[2]+t[3]+t[4]==0?$("#none-search").show():$("#none-search").hide()}function e(t){for(var e=0;e<a.length;e++)if(-1==t.indexOf(a[e]))return!1;return!0}var s=new bootstrap.Modal(document.getElementById("loading-mask"),{});s.show(),$.ajax({type:"get",url:"https://script.google.com/macros/s/AKfycbzUhd5WCInp5rgxZACrfrtc3ARVMvbqujIOgyx9OTFw_APRj86rmX7QfaSgMLOJPQ_diw/exec",success:function(t){var e=JSON.parse(t),a=e[0],n=e[1],l=e[2],r=e[3],i=e[4],o='<i class="bi bi-clipboard float-end copy-btn" title="複製答案"></i>';let c="";for(var d=1;d<a.length;d++)c+='<tr class="qq"><td class="tg-1">'+a[d][0]+'</td><td class="tg-2 align-middle">'+a[d][1]+o+"</td></tr>";for(d=1;d<n.length;d++)c+='<tr class="ko"><td class="tg-1">'+n[d][0]+'</td><td class="tg-2 align-middle">'+n[d][1]+"</td></tr>";for(d=1;d<l.length;d++){const t=l[d][1].split(",");let e="";c+='<tr class="tp"><td class="tg-1">'+l[d][0]+'</td><td class="tg-2 align-middle">';for(let s=0;s<t.length;s++)e+=`<li class="list-group-item" style="background: transparent; padding-left: 0px;">${t[s]}</li>`;c+=`<ul class="list-group list-group-flush" style="margin: 0px">${e}</ul></td></tr>`}document.getElementsByClassName("ques-body")[0].innerHTML=c;let g="";for(d=1;d<r.length;d++)g+='<tr class="gu"><td>'+r[d][0]+"</td><td>"+r[d][1]+"</td></tr>";document.getElementsByClassName("guwan-body")[0].innerHTML=g;let p="";for(d=1;d<i.length;d++)p+='<tr class="bu"><td>'+i[d][0]+"</td><td>"+i[d][1]+"</td></tr>";document.getElementsByClassName("buqhai-body")[0].innerHTML=p,document.getElementById("timecode").innerHTML="最後更新時間："+e[5][0],$(".table").on("click",".copy-btn",function(){var t=$(this).parent(),e=t.html().replace(o,"");navigator.clipboard.writeText(e);var s=$("#alert");s.css("opacity",1),s.animate({opacity:1},1e3).animate({opacity:0},300)}),s.hide()}});var a=[],n=$(".table"),l=[".qq,.ko,.tp,.gu,.bu",".qq",".tp",".ko",".gu",".bu"];$("#search").keyup(function(){var e=$("#search").val();if(0==e.length)return n.css("display","none"),void $("#none-search").hide();n.css("display",""),a=e.split(" "),t()}),$("#search-type").change(function(){$("#search").trigger("keyup")})});